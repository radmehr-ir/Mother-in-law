<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>ÛŒØ§Ø¯Ø¢ÙˆØ± - Ù…Ø§Ø¯Ø±ÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<nav>
  <a href="index.html">ğŸ  Ø®Ø§Ù†Ù‡</a>
  <a href="shopping.html">ğŸ›’ Ù„ÛŒØ³Øª Ø®Ø±ÛŒØ¯</a>
  <a href="reminder.html">â° ÛŒØ§Ø¯Ø¢ÙˆØ±</a>
</nav>

<h2>â° ÛŒØ§Ø¯Ø¢ÙˆØ±</h2>
<input type="datetime-local" id="reminderTime">
<input type="text" id="reminderText" placeholder="ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ...">
<select id="repeatType">
  <option value="once">ÛŒÚ©Ø¨Ø§Ø±</option>
  <option value="daily">Ù‡Ø± Ø±ÙˆØ²</option>
  <option value="monthly">Ù‡Ø± Ù…Ø§Ù‡</option>
  <option value="yearly">Ù‡Ø± Ø³Ø§Ù„</option>
</select>
<button onclick="setReminder()">ğŸ“Œ Ø«Ø¨Øª ÛŒØ§Ø¯Ø¢ÙˆØ±</button>

<h3>ğŸ“‹ Ù„ÛŒØ³Øª ÛŒØ§Ø¯Ø¢ÙˆØ±Ù‡Ø§</h3>
<ul id="reminderList"></ul>

<audio id="alarmSound" src="https://dl4.fara-download.ir/audio/sound_effect/alarms/phone/iphone/iPhone%20notification%20sound.mp3"></audio>

<script>
let reminders = JSON.parse(localStorage.getItem("reminders") || "[]");

// Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø¬Ø§Ø²Ù‡ Ø§Ø¹Ù„Ø§Ù†
if (Notification.permission !== "granted") {
  Notification.requestPermission();
}

function renderReminders() {
  document.getElementById("reminderList").innerHTML = reminders.map((r, i) =>
    `<li>${r.text} - ${new Date(r.time).toLocaleString()} (${r.repeat})</li>`
  ).join("");
}

function setReminder() {
  let time = new Date(document.getElementById("reminderTime").value).getTime();
  let text = document.getElementById("reminderText").value;
  let repeat = document.getElementById("repeatType").value;
  if (!time || !text) return alert("Ø²Ù…Ø§Ù† Ùˆ Ù…ØªÙ† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯");

  reminders.push({ time, text, repeat });
  localStorage.setItem("reminders", JSON.stringify(reminders));

  renderReminders();
  alert("âœ… ÛŒØ§Ø¯Ø¢ÙˆØ± Ø«Ø¨Øª Ø´Ø¯");
}

function showNotification(msg) {
  if (Notification.permission === "granted") {
    new Notification("â° ÛŒØ§Ø¯Ø¢ÙˆØ±", { body: msg });
  }
}

function checkReminders() {
  let now = Date.now();
  reminders.forEach((r, index) => {
    if (now >= r.time) {
      document.getElementById("alarmSound").play();
      showNotification(r.text);

      if (r.repeat === "daily") {
        r.time += 24 * 60 * 60 * 1000;
      } else if (r.repeat === "monthly") {
        let date = new Date(r.time);
        date.setMonth(date.getMonth() + 1);
        r.time = date.getTime();
      } else if (r.repeat === "yearly") {
        let date = new Date(r.time);
        date.setFullYear(date.getFullYear() + 1);
        r.time = date.getTime();
      } else {
        reminders.splice(index, 1); // ÛŒÚ©Ø¨Ø§Ø±
      }

      localStorage.setItem("reminders", JSON.stringify(reminders));
      renderReminders();
    }
  });
}

renderReminders();
setInterval(checkReminders, 1000);
</script>

</body>
</html>
